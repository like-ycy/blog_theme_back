---
title:      " 运维面试题系列--Linux问题 "
date:       2021-03-03
banner_img: "https://gitee.com/like-ycy/images/raw/master/blog/header.jpg"
tags: [ 面试 ]
---

## linux系统

### 1、linux启动过程

​    第一步：开机自检，加载BIOS

​    第二部：读取MBR

​    第三部：Boot Loader　grub引导菜单

​    第四步：加载kernel内核

​    第五步：init进程依据inittab文件夹来设定运行级别

​    第六步：init进程执行rc.sysinit

​    第七步：启动内核模块

​    第八步：执行不同运行级别的脚本程序

​    第九步：执行/etc/rc.d/rc.local

​    第十步：执行/bin/login程序，启动mingetty,进入登录状态

### 2、统计8888端口连接数     

```bash
netstat -ant | grep 8888
```

### 3、top命令根据关键字查看CPU、内存信息

```
top -c -p $(pgrep -d',' -f java)
```

### 4、分区工具 格式化工具  

```
fdisk /dev/sdb  按“p”，输入分区号，输入分区的大小，“w”保存
mkfs -t ext4 /dev/sdb1
```

### 5、查看日志中访问次数最多的前10个IP

```
cat access_log |cut -d ' ' -f 1 | sort |uniq -c | sort -nr | awk '{print $0 }' | head -n 10 | less
```

### 6、当前WEB服务器中连接次数最多的ip地址

```
netstat -ntu |awk '{print $5}' |sort | uniq -c| sort -nr
```

### 7、用iptables添加一个规则允许192.168.0.123访问本机3306端口

```
iptables -I INPUT -p tcp -s 192.168.0.123 -d 127.0.0.1 --dport 3306 -j ACCEPT
```

### 8、将本地80端口的请求转发到8080端口，当前主机IP为192.168.16.1，其中本地网卡eth0

```
iptables -t nat -A PREROUTING -p tcp -i eth0 -d 192.168.16.1 --dport 80 -j REDIRECT --to-port 8080
```

### 9、查看http的并发连接数与其TCP连接状态

```
netstat -n | awk '/^tcp/ {++b[$NF]} END {for(a in b) print a, b[a]}'
```

### 10、统计出apache的access.log中访问量最多的5个IP:

```
 cat access_log | awk  '{print $1}' | sort | uniq -c | sort -n -r | head -5  
```

### 11、通过apache访问日志access.log 统计IP和每个地址访问的次数，按访问量列出前10名。

```
cat /var/log/httpd/access_log |awk '{print $1}'|sort -r |head -10 |uniq -c
```

### 12、多进程与多线程，请问有什么区别？

（1）进程：子进程是父进程的复制品。 
（2）线程：一个进程可以容纳多个线程，相对进程而言，线程是一个更加接近与执行体的概念，它可以与同进程的其他线程共享资源，但拥有自己的栈空间，拥有独立的执行序列。 

两者都可以提高程序的并发度，提高程序运行效率和响应时间。 
同时，线程适合于在SMP机器上运行，而进程则可以跨机器迁移。 
根本区别就一点：用多进程每个进程有自己的地址空间(address space)，线程则共享地址空间。

所有其它区别都是由此而来的： 
（1）速度：线程产生的速度快，线程间的通讯快、切换快等，因为他们在同一个地址空间内。 
（2）资源利用率：线程的资源利用率比较好也是因为他们在同一个地址空间内。 
（3）同步问题：线程使用公共变量/内存时需要使用同步机制还是因为他们在同一个地址空间内。

### 13、linux下ext4和xfs文件系统的区别

EXT4是Linux系统下的日志文件系统，是EXT3文件系统的后继版本。

（1）Ext4的文件系统容量达到1EB，而文件容量则达到16TB

（2）理论上支持无限数量的子目录

（3）Ext4文件系统使用64位空间记录块数量和i-节点数量

（4）Ext4的多块分配器支持一次调用分配多个数据块

XFS

（1）根据所记录的日志在很短的时间内迅速恢复磁盘文件内容

（2）采用优化算法，日志记录对整体文件操作影响非常小

（3） 是一个全64-bit的文件系统，它可以支持上百万T字节的存储空间

（4）能以接近裸设备I/O的性能存储数据

### 14、linux top命令信息

请看之前文章：[Linux top命令参数详解](https://like-ycy.github.io/2020/06/29/2020-06-29-linux-top/)

### 15、端口time_wait过多，怎么解决

**内核参数优化：**

```
net.ipv4.tcp_syncookies = 1 表示开启SYN Cookies。当出现SYN等待队列溢出时，启用cookies来处理，可防范少量SYN攻击，默认为0，表示关闭； 
net.ipv4.tcp_tw_reuse = 1 表示开启重用。允许将TIME-WAIT sockets重新用于新的TCP连接，默认为0，表示关
net.ipv4.tcp_tw_recycle = 1 表示开启TCP连接中TIME-WAIT sockets的快速回收，默认为0，表示关闭。 
net.ipv4.tcp_fin_timeout 修改系默认的 TIMEOUT 时间
```

### 16、linux 软，硬链接区别

- 硬链接：在Linux系统中，多个文件名指向同一索引节点(Inode)是正常且允许的。一般这种链接就称为硬链接。硬链接的作用之一是允许一个文件拥有多个有效路径名，这样用户就可以建立硬链接到重要的文件，以防止“误删”源数据。
- 软链接： 软链接就是一个普通文件，只是数据块内容有点特殊，文件用户数据块中存放的内容是另一文件的路径名的指向，通过这个方式可以快速定位到软连接所指向的源文件实体。软链接可对文件或目录创建。

软连接和硬链接的特点：

**软链接：**

- 1.软链接是存放另一个文件的路径的形式存在。
- 2.软链接可以 跨文件系统 ，硬链接不可以。
- 3.软链接可以对一个不存在的文件名进行链接，硬链接必须要有源文件。
- 4.软链接可以对目录进行链接。

**硬链接：**

- 1. 硬链接，以文件副本的形式存在。但不占用实际空间。
- 1. 不允许给目录创建硬链接。
- 1. 硬链接只有在同一个文件系统中才能创建。
- 1. 删除其中一个硬链接文件并不影响其他有相同 inode 号的文件。

### 17、linux kill进程退出指令

| 信号编号 | 信号名 | 含义                                                         |
| -------- | ------ | ------------------------------------------------------------ |
| 0        | EXIT   | 程序退出时收到该信息。                                       |
| 1        | HUP    | 挂掉电话线或终端连接的挂起信号，这个信号也会造成某些进程在没有终止的情况下重新初始化。 |
| 2        | INT    | 表示结束进程，但并不是强制性的，常用的 "Ctrl+C" 组合键发出就是一个 kill -2 的信号。 |
| 3        | QUIT   | 退出。                                                       |
| 9        | KILL   | 杀死进程，即强制结束进程。                                   |
| 11       | SEGV   | 段错误。                                                     |
| 15       | TERM   | 正常结束进程，是 kill 命令的默认信号。                       |

### 18、Linux中CPU使用率 和 load的关系

- CPU使用率
  一段时间之中，CPU用于执行任务占用的时间与总的时间的比率
- load
  Load average是指上一分钟同时处于就绪状态的平均进程数。在CPU中可以理解为CPU可以并行处理的任务数量，就是CPU个数X核数。如果CPU Load等于CPU个数乘以核数，那么就说CPU正好满负载，再多一点，可能就要出问题了

对于CPU密集型任务 通常是 cpu使用率和load都很高
对于IO密集型任务 通常是cpu使用率不高 但load很高



